# IMDB Spark Project

Проєкт аналізу даних IMDb за допомогою **PySpark**.

## Структура проєкту
main.py
modules/
??? extract.py – завантаження даних
??? transform.py – бізнес-запити та збереження
??? analysis.py – машинне навчання
data/ – локальні дані
output/ – результати


## ?? Етапи виконання

1. **Екстракція** – зчитування IMDb датасету через `SparkSession`  
2. **Трансформація** – 10 бізнес-запитів (filters, joins, groupBy, window)  
3. **Збереження результатів** – у `output/results.csv`  
4. **Аналіз (ML)** – моделі:
   - LinearRegression  
   - DecisionTreeRegressor  
   - LogisticRegression  
   - RandomForestClassifier  
   - DecisionTreeClassifier  

## ?? Метрики
| Тип | Модель | RMSE / R? | Accuracy / F1 | Precision / Recall |
|-----|---------|------------|----------------|--------------------|
| Регресія | LinearRegression | RMSE ? 1849, R? ? 0.0 | – | – |
| Регресія | DecisionTreeRegressor | RMSE ? 1849, R? ? 0.00001 | – | – |
| Класифікація | LogisticRegression | Accuracy ? 0.961, F1 ? 0.94 | Precision ? 0.94, Recall ? 0.93 |  
| Класифікація | RandomForestClassifier | Accuracy ? 0.961, F1 ? 0.94 | Precision ? 0.94, Recall ? 0.93 |  
| Класифікація | DecisionTreeClassifier | Accuracy ? 0.961, F1 ? 0.94 | Precision ? 0.94, Recall ? 0.93 |

## ?? Висновки
- Дані IMDb містять ~12 млн записів.  
- Runtime майже не залежить від року (R? ? 0).  
- Класифікаційні моделі показують високу точність (>96%).  
- **DecisionTreeRegressor** має трохи кращу узгодженість, ніж LinearRegression.  
- Для класифікації **RandomForestClassifier** показує найкращий баланс Precision/Recall.  

---

## Бізнес-запити – короткий аналіз

| № | Запит | Висновок |
|---|-------|-----------|
| 1 | Кількість фільмів у кожному жанрі | Найбільше — *Drama*, *Comedy*
| 2 | Фільми по роках | Пік у 2024–2025 роках |
| 3 | Топ-10 найдовших | Експериментальні або арт-відео |
| 4 | Фільми для дорослих | Переважно 1960–1970-ті |
| 5 | Короткі фільми <10 хв | ~0.5 млн короткометражок |
| 6 | Середня тривалість за жанрами | Документальні — довші за середнє |
| 7 | Join із рейтингами | Перевірка коректності злиття |
| 8 | Join фільмів >6.0 рейтингу | Збігається з найвідомішими короткометражками |
| 9 | Window – найдовший фільм у жанрі | Візуально довгі або стрім-проекти |
| 10 | Window – середня тривалість по жанрах | Показує варіативність жанрів |

---

## Виконання
python main.py

---

## Автор
**Богдан Комарницький**, група ШІ-42 
**НУ “Львівська політехніка”**, 2025 р.

---

## Примітки

Docker Desktop не підтримується на Windows 10 LTSC 17763 ? виконано локальний сценарій встановлення.

Дані (data/) та output/ не відслідковуються Git (див. .gitignore).